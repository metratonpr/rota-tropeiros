<section id="horarios" class="py-5 bg-white">
    <div class="container">
        <div class="d-flex flex-column flex-lg-row justify-content-between align-items-start mb-4">
            <div>
                <h2 class="section-title fw-semibold mb-2">Horários por linha</h2>
                <p class="section-subtitle mb-0">
                    Selecione a linha desejada para consultar paradas estratégicas, horários previstos e intervalos médios.
                </p>
            </div>
            <a class="btn btn-outline-primary mt-3 mt-lg-0" href="#contato">Solicitar linha adicional</a>
        </div>
        
        <ul class="nav nav-underline schedule-tabs mb-4" id="lineTabs" role="tablist">
            {% for rota in rotas %}
            <li class="nav-item" role="presentation">
                <button class="nav-link {% if forloop.first %}active{% endif %}" 
                        id="tab-{{ rota.id }}" 
                        data-bs-toggle="tab" 
                        data-bs-target="#linha{{ rota.id }}" 
                        type="button" 
                        role="tab" 
                        aria-controls="linha{{ rota.id }}" 
                        aria-selected="{% if forloop.first %}true{% else %}false{% endif %}"
                        data-route="linha{{ rota.id }}">
                    {{ rota.nome }}
                </button>
            </li>
            {% endfor %}
        </ul>
        
        <div class="tab-content">
            {% for rota in rotas %}
            <div class="tab-pane fade {% if forloop.first %}show active{% endif %}" 
                 id="linha{{ rota.id }}" 
                 role="tabpanel" 
                 aria-labelledby="tab-{{ rota.id }}">
                <div class="schedule-card p-4">
                    <h5 class="fw-semibold mb-3" style="color: var(--vm-primary);">{{ rota.nome }}</h5>
                    <div class="row g-4">
                        <div class="col-lg-8">
                            <table class="table align-middle mb-0">
                                <thead>
                                    <tr>
                                        <th scope="col">Parada</th>
                                        <th scope="col">Próximo</th>
                                        <th scope="col">Seguinte</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for horario in rota.horarios_parada.all %}
                                    {% if horario.ativo %}
                                    <tr>
                                        <td>{{ horario.parada.endereco }}</td>
                                        <td>{{ horario.horario|date:"H:i" }}</td>
                                        <td>{{ horario.proximo_horario|date:"H:i"|default:"—" }}</td>
                                    </tr>
                                    {% endif %}
                                    {% empty %}
                                    <tr>
                                        <td colspan="3" class="text-center text-muted">Nenhum horário cadastrado</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <div class="col-lg-4">
                            <div class="callout p-4 h-100">
                                <h6 class="text-uppercase text-muted">Informações</h6>
                                <p class="fw-semibold mb-2">{{ rota.nome }}</p>
                                <p class="text-muted mb-0">
                                    Acompanhe os horários em tempo real através do mapa interativo abaixo.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
